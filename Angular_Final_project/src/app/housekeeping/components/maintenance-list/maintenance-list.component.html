<app-sidebar></app-sidebar>

<div class="content-wrapper">

  <h2 class="page-title">
    <i class="fas fa-tools"></i>
    Maintenance Requests
  </h2>

  <div class="table-card" *ngIf="requests.length > 0">

    <table class="custom-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Description</th>
          <th>Status</th>
          <th class="actions-col">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let req of requests">

          <td>{{ req.id }}</td>

          <!-- Description -->
          <td *ngIf="editingRequestId !== req.id">
            {{ req.description }}
          </td>
          <td *ngIf="editingRequestId === req.id">
            <input [(ngModel)]="req.description" />
          </td>

          <!-- Status -->
          <td *ngIf="editingRequestId !== req.id">
            <span class="status-badge" [ngClass]="req.status.toLowerCase()">
              {{ req.status }}
            </span>
          </td>
          <td *ngIf="editingRequestId === req.id">
            <select [(ngModel)]="req.status" class="status-select">
              <option *ngFor="let s of statuses" [value]="s">{{ s }}</option>
            </select>
          </td>

          <!-- Actions -->
          <td class="actions">
            <button class="btn edit"
              *ngIf="editingRequestId !== req.id"
              (click)="startEdit(req.id)">
              Edit
            </button>

            <button class="btn update"
              *ngIf="editingRequestId === req.id"
              (click)="updateRequest(req)">
              Update
            </button>

            <button class="btn cancel"
              *ngIf="editingRequestId === req.id"
              (click)="cancelEdit()">
              Cancel
            </button>

            <button class="btn delete"
              (click)="deleteRequest(req.id)">
              Delete
            </button>
          </td>

        </tr>
      </tbody>
    </table>

  </div>

  <p *ngIf="requests.length === 0" class="empty">
    No maintenance requests found.
  </p>

  <!-- Form -->
  <div class="form-section">
    <app-maintenance-form (saved)="loadRequests()"></app-maintenance-form>
  </div>

</div>
